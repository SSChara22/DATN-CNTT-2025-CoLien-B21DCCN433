@startuml
skinparam classAttributeIconSize 0
skinparam roundcorner 8
skinparam shadowing false
skinparam linetype ortho

skinparam padding 1
skinparam nodesep 1
skinparam ranksep 1

skinparam class {
    BackgroundColor #E1F5FF
    BorderColor #0066CC
    ArrowColor #0066CC
    FontColor #000000
    FontStyle bold
    FontSize 7
}

skinparam package {
    BackgroundColor #F0F0F0
    BorderColor #666666
    FontColor #000000
    FontStyle bold
    FontSize 8
}

title Biểu đồ lớp phân tích - Hệ thống E-commerce\n(Analysis Class Diagram)

package "Core" #DDDDDD {
    class User {
        +id: Integer
    }

    class Product {
        +id: Integer
    }

    class Order {
        +id: Integer
    }

    class Recommendation {
        +id: Integer
    }
}

package "Product" #DDDDDD {
    class ProductDetail {
        +id: Integer
    }

    class ProductDetailSize {
        +id: Integer
    }
}

package "Order" #DDDDDD {
    class OrderDetail {
        +id: Integer
    }

    class ShopCart {
        +id: Integer
    }
}

package "ML" #DDDDDD {
    abstract class RecommendationModel {
        <<abstract>>
        +predict(): Float[]
    }

    class ENCM {
        +predict(): Float[]
    }

    class RecommendationEngine {
        +generateRecommendations(): Recommendation[]
    }
}

' Relationships
User "1" --> "0..*" Order : places
User "1" --> "0..*" ShopCart : has
User "1" --> "0..*" Recommendation : receives

Product "1" --> "0..*" ProductDetail : has
Product "1" --> "0..*" Recommendation : recommended_in

ProductDetail "1" --> "1" Product : belongs
ProductDetail "1" --> "0..*" ProductDetailSize : has

ProductDetailSize "1" --> "1" ProductDetail : belongs
ProductDetailSize "1" --> "0..*" ShopCart : in_cart
ProductDetailSize "1" --> "0..*" OrderDetail : in_orders

Order "1" --> "0..*" OrderDetail : contains
Order "1" --> "1" User : belongs

OrderDetail "1" --> "1" Order : belongs
OrderDetail "1" --> "1" ProductDetailSize : references

ShopCart "1" --> "1" User : belongs
ShopCart "1" --> "1" ProductDetailSize : contains

Recommendation "1" --> "1" User : for_user
Recommendation "1" --> "1" Product : recommends

RecommendationEngine "1" --> "1..*" RecommendationModel : uses
RecommendationModel <|-- ENCM
RecommendationEngine --> User : generates_for
RecommendationEngine --> Product : recommends

@enduml
