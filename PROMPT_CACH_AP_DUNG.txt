Viết hướng dẫn chi tiết về cách áp dụng và triển khai hệ thống gợi ý sản phẩm thương mại điện tử theo ngữ cảnh với các yêu cầu sau:

HỆ THỐNG BAO GỒM:
- Frontend: React.js
- Backend API: Node.js (Express)
- ML Service: Python (TensorFlow models)
- Database: MySQL

CẦN VIẾT CÁC PHẦN SAU:

1. CHUẨN BỊ MÔI TRƯỜNG:
   - Yêu cầu hệ thống (Node.js, Python, MySQL)
   - Cài đặt dependencies (npm packages, pip packages)
   - Cấu hình biến môi trường (.env)
   - Database setup (tạo database, chạy migrations)

2. CÀI ĐẶT VÀ CẤU HÌNH:
   - Setup Backend API (Node.js):
     * Cài đặt packages: npm install
     * Cấu hình database connection
     * Cấu hình Python invoker (PYTHON_BIN path)
     * Setup routes cho recommendations API
   - Setup ML Models (Python):
     * Cài đặt: pip install -r requirements.txt
     * Kiểm tra model files (.h5, .json configs)
     * Cấu hình database connection cho Python
     * Test model loading
   - Setup Frontend (React):
     * Cài đặt packages: npm install
     * Cấu hình API endpoint
     * Setup interaction tracking

3. CHUẨN BỊ DỮ LIỆU:
   - Import dữ liệu sản phẩm vào database
   - Tạo encoders (user_encoder, item_encoder) từ dữ liệu
   - Migrate encoders vào database (bảng rec_user_encoder, rec_item_encoder)
   - Load context mappings (time_of_day, season, device_type, category)
   - Đảm bảo có đủ dữ liệu interactions để train/evaluate

4. TRAIN HOẶC LOAD MODELS:
   - Nếu chưa có models: Hướng dẫn train 4 models (ENCM, LNCM, NeuMF, BMF)
   - Nếu đã có models: Kiểm tra file weights (.h5) và configs (.json)
   - Verify model files tồn tại và có thể load được

5. TRIỂN KHAI:
   - Backend API:
     * Start server: npm start hoặc nodemon
     * Test endpoints: /api/recommendations/init, /api/recommendations/list
     * Verify Python invoker hoạt động
   - Python ML Service:
     * Test recommend_api.py có thể chạy độc lập
     * Verify có thể gọi từ Node.js
   - Frontend:
     * Start dev server: npm start
     * Test gọi API recommendations
     * Test interaction tracking (view, cart, purchase)

6. SỬ DỤNG API:
   - Endpoint khởi tạo gợi ý: GET /api/recommendations/init?limit=10
   - Endpoint lấy gợi ý: GET /api/recommendations/list?limit=10
   - Endpoint xóa cache: DELETE /api/recommendations/clear
   - Dashboard: GET /api/recommendations/dashboard
   - Ví dụ request/response JSON

7. TÍCH HỢP VÀO FRONTEND:
   - Cách gọi API recommendations từ React component
   - Hiển thị danh sách sản phẩm được gợi ý
   - Tích hợp interaction tracking (trackView, trackCart, trackPurchase)
   - Auto-refresh recommendations khi có interaction mới

8. CẤU HÌNH NÂNG CAO:
   - Tùy chỉnh trọng số cho heuristic scoring
   - Cấu hình timeout cho Python invoker
   - Tùy chỉnh số lượng gợi ý mặc định
   - Cấu hình cache expiration

9. MONITORING VÀ MAINTENANCE:
   - Kiểm tra logs (Backend, Python)
   - Monitor model performance (MAP@10, Precision@10)
   - Xem metrics trong bảng model_runs
   - Refresh recommendations định kỳ
   - Retrain models khi có dữ liệu mới

10. TROUBLESHOOTING:
    - Lỗi Python không chạy được
    - Lỗi model không load được
    - Lỗi database connection
    - Lỗi encoding user/item
    - Fallback về heuristic scoring

YÊU CẦU:
- Viết bằng tiếng Việt, rõ ràng, dễ hiểu
- Có ví dụ code cụ thể
- Có các bước kiểm tra (checklist)
- Có phần troubleshooting phổ biến
- Format markdown với code blocks
- Bao gồm cả phần production deployment nếu có thể

OUTPUT: Tài liệu hướng dẫn đầy đủ, có thể sử dụng ngay để triển khai hệ thống.







